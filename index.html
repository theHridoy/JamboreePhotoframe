<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3rd National ICT Scout Jamboree 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Orbitron:wght@500;700&family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --cyber-purple: #8A2BE2;
            --cyber-blue: #00FFFF;
            --cyber-green: #00FF7F;
            --cyber-red: #FF4500;
            --cyber-dark: #1A1A2E;
            --cyber-black: #0F0F1A;
            --cyber-grey: #4A4A5A;
            --cyber-light-grey: #C0C0C0;
            --cyber-white: #FFFFFF;
        }
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: var(--cyber-dark);
            color: var(--cyber-light-grey);
            overflow-x: hidden;
        }
        h1, h2, h3, h4, .font-heading {
            font-family: 'Orbitron', sans-serif;
            color: var(--cyber-blue);
        }
        .text-cyber-purple { color: var(--cyber-purple); }
        .bg-cyber-purple { background-color: var(--cyber-purple); }
        .text-cyber-blue { color: var(--cyber-blue); }
        .bg-cyber-blue { background-color: var(--cyber-blue); }
        .text-cyber-green { color: var(--cyber-green); }
        .bg-cyber-green { background-color: var(--cyber-green); }
        .text-cyber-red { color: var(--cyber-red); }
        .bg-cyber-red { background-color: var(--cyber-red); }
        .text-cyber-dark { color: var(--cyber-dark); }
        .bg-cyber-dark { background-color: var(--cyber-dark); }
        .text-cyber-light-grey { color: var(--cyber-light-grey); }
        .bg-cyber-light-grey { background-color: var(--cyber-light-grey); }

        .header-bg {
            background: radial-gradient(circle at top left, var(--cyber-purple) 0%, transparent 40%),
                        radial-gradient(circle at bottom right, var(--cyber-blue) 0%, transparent 40%),
                        var(--cyber-black);
            background-size: 200% 200%;
            animation: gradient-shift 15s ease infinite;
            border: 2px solid var(--cyber-purple);
            box-shadow: 0 0 20px var(--cyber-purple);
        }
        @keyframes gradient-shift {
            0% { background-position: 0% 0%; }
            50% { background-position: 100% 100%; }
            100% { background-position: 0% 0%; }
        }
        .glitch-text {
            text-shadow: 1px 1px var(--cyber-red), -1px -1px var(--cyber-blue);
        }

        .canvas-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1 / 1;
            margin: auto;
        }
        #canvas {
            display: block;
            border-radius: 1.5rem;
            width: 100%;
            height: 100%;
            touch-action: none;
            cursor: grab;
            border: 2px solid var(--cyber-blue);
            box-shadow: 0 0 15px var(--cyber-blue);
        }
        #canvas.dragging {
            cursor: grabbing;
        }

        .link-button {
            transition: all 0.3s ease-in-out;
            transform: scale(1);
            background-color: var(--cyber-purple);
            color: var(--cyber-white);
            border: 2px solid var(--cyber-blue);
        }
        .link-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--cyber-blue);
            background-color: var(--cyber-blue);
        }

        .cta-button {
            transition: all 0.3s ease-in-out;
            border: 2px solid var(--cyber-green);
            background-color: transparent;
            color: var(--cyber-green);
            text-shadow: 0 0 5px var(--cyber-green);
        }
        .cta-button:hover {
            transform: translateY(-2px) scale(1.05);
            background-color: var(--cyber-green);
            color: var(--cyber-black);
            box-shadow: 0 0 20px var(--cyber-green);
        }

        .zoom-button, .filter-button {
            background-color: var(--cyber-black);
            color: var(--cyber-blue);
            border: 2px solid var(--cyber-blue);
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
            transition: all 0.2s ease-in-out;
        }
        .zoom-button:hover, .filter-button:hover {
            background-color: var(--cyber-blue);
            color: var(--cyber-black);
            box-shadow: 0 0 15px var(--cyber-blue);
            transform: translateY(-2px);
        }
        .filter-button.active {
            background-color: var(--cyber-green);
            color: var(--cyber-black);
            border-color: var(--cyber-green);
            box-shadow: 0 0 15px var(--cyber-green);
        }
        
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: var(--cyber-grey);
            outline: none;
            opacity: 0.7;
            border-radius: 4px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--cyber-blue);
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 0 10px var(--cyber-blue);
            border: 2px solid var(--cyber-black);
        }
        
        #filter-buttons {
            display: flex;
            overflow-x: auto;
            scroll-behavior: smooth;
            padding-bottom: 0.5rem;
            -webkit-overflow-scrolling: touch;
            justify-content: flex-start;
            flex-wrap: nowrap;
            gap: 0.5rem;
        }
        #filter-buttons::-webkit-scrollbar {
            height: 6px;
        }
        #filter-buttons::-webkit-scrollbar-thumb {
            background: var(--cyber-blue);
            border-radius: 10px;
        }
        #filter-buttons::-webkit-scrollbar-track {
            background: var(--cyber-dark);
            border-radius: 10px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 bg-cyber-dark">

<main class="w-full h-full flex flex-col items-center">
    <header class="text-center p-6 md:p-10 w-full header-bg rounded-3xl shadow-2xl flex flex-col md:flex-row items-center justify-center space-x-0 md:space-x-6">
        <img src="logo.png" alt="ICT Scout Jamboree 2025 Logo" class="h-24 w-auto object-contain mb-4 md:mb-0 filter-invert">
        <div class="flex flex-col items-center md:items-start">
            <h1 class="text-4xl lg:text-5xl font-extrabold tracking-wide glitch-text">Bangladesh Scouts</h1>
            <h2 class="text-xl lg:text-2xl font-medium mt-2 glitch-text">National ICT Scout Jamboree 2025</h2>
        </div>
    </header>

    <section class="bg-cyber-black rounded-3xl shadow-lg p-6 md:p-10 mt-8 w-full max-w-4xl border border-cyber-blue">
        <h3 class="text-2xl md:text-3xl font-bold text-cyber-blue text-center mb-4 fade-in-up font-heading">Ready to Dive into the Digital World? üöÄ</h3>
        <p class="text-cyber-light-grey text-base leading-relaxed text-center mx-auto mb-6 fade-in-up" style="animation-delay: 0.2s;">
            Gear up for an unforgettable journey at the 3rd National ICT Scout Jamboree 2025! We‚Äôre merging cutting-edge tech with the spirit of community at the National Scout Training Center ‚Äî get ready for an adventure like no other!
        </p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left mb-6">
            <div class="fade-in-up">
                <p class="font-bold text-xl text-cyber-blue mb-1 font-heading">When?</p>
                <p class="text-cyber-light-grey">üìÖ 19th‚Äì21st September 2025</p>
            </div>
            <div class="fade-in-up" style="animation-delay: 0.3s;">
                <p class="font-bold text-xl text-cyber-blue mb-1 font-heading">Where?</p>
                <p class="text-cyber-light-grey">üìç National Scout Training Center, Mouchak, Gazipur</p>
            </div>
            <div class="fade-in-up" style="animation-delay: 0.4s;">
                <p class="font-bold text-xl text-cyber-blue mb-1 font-heading">Our Vibe</p>
                <p class="text-cyber-light-grey">‚Äú‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø ‡¶π‡ßã‡¶ï ‡¶∏‡¶¨‡¶æ‡¶∞ / Let Technology Serve Humanity‚Äù</p>
            </div>
        </div>
        
        <h4 class="font-bold text-2xl text-cyber-blue text-center my-6 fade-in-up font-heading" style="animation-delay: 0.5s;">Why You Gotta Be There?</h4>
        <ul class="list-none space-y-4 max-w-2xl mx-auto text-left fade-in-up" style="animation-delay: 0.6s;">
            <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyber-green mr-3 mt-1 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-cyber-light-grey text-base">Get hands-on at AI workshops and dive deep into the future!</span>
            </li>
            <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyber-green mr-3 mt-1 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-cyber-light-grey text-base">Watch jaw-dropping Robotics demos and explore mind-blowing ICT projects.</span>
            </li>
            <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyber-green mr-3 mt-1 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-cyber-light-grey text-base">Tons of fun activities and challenges that‚Äôll keep you on your toes.</span>
            </li>
            <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyber-green mr-3 mt-1 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-cyber-light-grey text-base">Meet new friends and build lasting connections.</span>
            </li>
        </ul>

        <div class="flex flex-col md:flex-row justify-center items-center mt-6 space-y-4 md:space-y-0 md:space-x-8">
            <a href="https://www.facebook.com/share/16ypNQm7uG/" target="_blank" class="link-button py-3 px-8 rounded-full font-semibold bg-cyber-purple hover:bg-cyber-blue">
                Check out the Event Page
            </a>
            <a href="https://www.facebook.com/bangladeshscouts.NHQ" target="_blank" class="link-button py-3 px-8 rounded-full font-semibold bg-cyber-purple hover:bg-cyber-blue">
                Visit our Facebook Page
            </a>
        </div>
    </section>

    <section class="text-center p-6 md:p-10 w-full">
        <h3 class="text-2xl font-bold text-cyber-blue mb-4 font-heading">How to Join the Fun:</h3>
        <ul class="list-none text-cyber-light-grey space-y-3 max-w-xl mx-auto text-left md:text-center">
            <li>
                <span class="font-semibold text-cyber-green">Step 1:</span> Click the "Upload Your Photo" button and select a pic from your device.
            </li>
            <li>
                <span class="font-semibold text-cyber-green">Step 2:</span> **Drag the photo with your mouse or finger** and use the zoom controls to adjust the view.
            </li>
            <li>
                <span class="font-semibold text-cyber-green">Step 3:</span> When it looks perfect, hit "Download Photo Frame" and save it!
            </li>
        </ul>
    </section>

    <div class="canvas-container relative rounded-3xl bg-cyber-black w-full max-w-2xl border-2 border-cyber-blue shadow-lg">
        <canvas id="canvas" class="rounded-3xl"></canvas>
    </div>

    <section class="mt-8 flex flex-col items-center space-y-4 w-full max-w-2xl">
        <label for="photo-upload" class="cursor-pointer cta-button text-white font-semibold py-3 px-6 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
            Upload Your Photo
        </label>
        <input type="file" id="photo-upload" accept="image/*" class="hidden">

        <div id="controls" class="w-full flex flex-col items-center space-y-4 mt-4 hidden">
            <div id="zoom-controls-container" class="w-full flex items-center justify-center max-w-sm">
                <button id="zoom-out" class="zoom-button p-2 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 12H6"/>
                    </svg>
                </button>
                <input type="range" id="zoom-slider" min="1.0" max="3.0" step="0.01" value="1.0" class="flex-grow mx-4">
                <button id="zoom-in" class="zoom-button p-2 rounded-full">
                    <svg xmlns="http://www.w3.org/0000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                    </svg>
                </button>
            </div>
            
            <div id="filter-buttons" class="flex space-x-4 max-w-full">
                <button data-filter="none" class="filter-button py-2 px-4 active">Normal</button>
                <button data-filter="grayscale" class="filter-button py-2 px-4">Grayscale</button>
                <button data-filter="sepia" class="filter-button py-2 px-4">Sepia</button>
                <button data-filter="invert" class="filter-button py-2 px-4">Invert</button>
                <button data-filter="vivid" class="filter-button py-2 px-4">Vivid</button>
                <button data-filter="vintage" class="filter-button py-2 px-4">Vintage</button>
                <button data-filter="noir" class="filter-button py-2 px-4">Noir</button>
                <button data-filter="lomo" class="filter-button py-2 px-4">Lomo</button>
            </div>
        </div>
        
        <button id="download-btn" class="w-full max-w-xs cta-button text-white font-bold py-3 px-6 rounded-full transition-colors duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
            Download Photo Frame
        </button>
    </section>

    <div id="message-box" class="message-box bg-cyber-black rounded-xl p-8 shadow-2xl text-center hidden border border-cyber-blue">
        <h3 id="message-title" class="text-2xl font-bold mb-4 font-heading text-cyber-blue"></h3>
        <p id="message-text" class="text-cyber-light-grey mb-6"></p>
        <a id="close-message" href="https://www.facebook.com/profile.php" target="_blank" class="link-button text-white font-semibold py-3 px-4 md:px-8 rounded-full">
            Make Profile Picture
        </a>
    </div>
</main>

<footer class="mt-12 w-full text-center text-sm text-cyber-grey p-4">
    <p>¬© Media Cell, 3rd National ICT Scout Jamboree 2025</p>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const photoUpload = document.getElementById('photo-upload');
        const downloadBtn = document.getElementById('download-btn');
        const zoomSlider = document.getElementById('zoom-slider');
        const zoomInBtn = document.getElementById('zoom-in');
        const zoomOutBtn = document.getElementById('zoom-out');
        const controlsDiv = document.getElementById('controls');
        const filterButtons = document.querySelectorAll('#filter-buttons button');
        
        const messageBox = document.getElementById('message-box');
        const messageTitle = document.getElementById('message-title');
        const messageText = document.getElementById('message-text');
        const closeMessageBtn = document.getElementById('close-message');

        let photo = null;
        let frame = new Image();
        let photoData = {
            scale: 1.0,
            x: 0,
            y: 0,
            naturalWidth: 0,
            naturalHeight: 0,
            drawnWidth: 0,
            drawnHeight: 0,
            minScale: 1.0
        };
        let isDragging = false;
        let lastPointerX, lastPointerY;
        let activeFilter = 'none';
        
        frame.onload = () => {
            fitCanvasToScreen();
            draw();
        };
        frame.src = 'frame.png';

        function fitCanvasToScreen() {
            const container = document.querySelector('.canvas-container');
            const displayResolution = Math.min(container.clientWidth, 1024);
            canvas.width = displayResolution;
            canvas.height = displayResolution;
            
            if (photo) {
                updatePhotoState();
                centerPhoto();
            }
            draw();
        }

        function updatePhotoState() {
            if (!photo) return;
            const canvasRatio = canvas.width / canvas.height;
            const photoRatio = photoData.naturalWidth / photoData.naturalHeight;
            
            let scaleToCover;
            if (photoRatio > canvasRatio) {
                scaleToCover = canvas.height / photoData.naturalHeight;
            } else {
                scaleToCover = canvas.width / photoData.naturalWidth;
            }

            photoData.drawnWidth = photoData.naturalWidth * photoData.scale * scaleToCover;
            photoData.drawnHeight = photoData.naturalHeight * photoData.scale * scaleToCover;
            
            photoData.minScale = scaleToCover;
            zoomSlider.min = photoData.minScale;

            if (photoData.scale < photoData.minScale) {
                photoData.scale = photoData.minScale;
                zoomSlider.value = photoData.minScale;
                centerPhoto();
            }
        }
        
        function centerPhoto() {
             if (!photo) return;
             photoData.x = (canvas.width - photoData.drawnWidth) / 2;
             photoData.y = (canvas.height - photoData.drawnHeight) / 2;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'var(--cyber-dark)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (photo) {
                ctx.filter = getFilterValue(activeFilter);
                ctx.drawImage(photo, photoData.x, photoData.y, photoData.drawnWidth, photoData.drawnHeight);
                ctx.filter = 'none';
            }
            ctx.drawImage(frame, 0, 0, canvas.width, canvas.height);
        }
        
        function getFilterValue(filter) {
            switch (filter) {
                case 'grayscale': return 'grayscale(100%)';
                case 'sepia': return 'sepia(100%)';
                case 'invert': return 'invert(100%)';
                case 'vivid': return 'saturate(200%) contrast(120%) brightness(105%)';
                case 'vintage': return 'sepia(50%) saturate(150%) brightness(90%) contrast(110%)';
                case 'noir': return 'grayscale(100%) contrast(130%) brightness(80%)';
                case 'lomo': return 'sepia(20%) contrast(140%) brightness(80%) saturate(180%)';
                default: return 'none';
            }
        }

        photoUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    photo = new Image();
                    photo.onload = () => {
                        photoData.naturalWidth = photo.naturalWidth;
                        photoData.naturalHeight = photo.naturalHeight;
                        
                        const constrainedScale = Math.max(canvas.width / photoData.naturalWidth, canvas.height / photoData.naturalHeight);
                        photoData.scale = constrainedScale;
                        zoomSlider.value = constrainedScale;
                        zoomSlider.min = constrainedScale;

                        updatePhotoState();
                        centerPhoto();
                        
                        draw();
                        controlsDiv.classList.remove('hidden');
                        downloadBtn.classList.remove('hidden');
                    };
                    photo.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        const zoomBy = (factor) => {
            if (!photo) return;
            const oldScale = photoData.scale;
            const newScale = photoData.scale * factor;
            
            photoData.scale = Math.max(photoData.minScale, Math.min(3.0, newScale));
            zoomSlider.value = photoData.scale;
            
            const zoomFactor = photoData.scale / oldScale;
            photoData.x = canvas.width / 2 - (canvas.width / 2 - photoData.x) * zoomFactor;
            photoData.y = canvas.height / 2 - (canvas.height / 2 - photoData.y) * zoomFactor;

            updatePhotoState();
            
            if (photoData.scale === photoData.minScale) {
                centerPhoto();
            } else {
                constrainPhotoPosition();
            }

            draw();
        };

        zoomInBtn.addEventListener('click', () => zoomBy(1.1));
        zoomOutBtn.addEventListener('click', () => zoomBy(0.9));

        zoomSlider.addEventListener('input', (e) => {
            if (photo) {
                const oldScale = photoData.scale;
                photoData.scale = parseFloat(e.target.value);
                
                const zoomFactor = photoData.scale / oldScale;
                photoData.x = canvas.width / 2 - (canvas.width / 2 - photoData.x) * zoomFactor;
                photoData.y = canvas.height / 2 - (canvas.height / 2 - photoData.y) * zoomFactor;

                updatePhotoState();
                if (photoData.scale === photoData.minScale) {
                    centerPhoto();
                } else {
                    constrainPhotoPosition();
                }
                draw();
            }
        });

        function constrainPhotoPosition() {
            if (!photo) return;
            const minX = canvas.width - photoData.drawnWidth;
            const minY = canvas.height - photoData.drawnHeight;
            const maxX = 0;
            const maxY = 0;

            photoData.x = Math.min(maxX, Math.max(photoData.x, minX));
            photoData.y = Math.min(maxY, Math.max(photoData.y, minY));
        }

        filterButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                if (photo) {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    activeFilter = e.target.dataset.filter;
                    draw();
                }
            });
        });

        downloadBtn.addEventListener('click', () => {
            if (photo) {
                const finalCanvas = document.createElement('canvas');
                const finalCtx = finalCanvas.getContext('2d');
                
                finalCanvas.width = photoData.naturalWidth;
                finalCanvas.height = photoData.naturalHeight;

                const displayToFinalRatio = finalCanvas.width / canvas.width; 

                const finalPhotoWidth = photoData.drawnWidth * displayToFinalRatio;
                const finalPhotoHeight = photoData.drawnHeight * displayToFinalRatio;
                const finalPhotoX = photoData.x * displayToFinalRatio;
                const finalPhotoY = photoData.y * displayToFinalRatio;

                finalCtx.filter = getFilterValue(activeFilter);
                
                finalCtx.drawImage(
                    photo,
                    finalPhotoX,
                    finalPhotoY,
                    finalPhotoWidth, 
                    finalPhotoHeight
                );
                
                finalCtx.filter = 'none';

                finalCtx.drawImage(frame, 0, 0, finalCanvas.width, finalCanvas.height);

                const link = document.createElement('a');
                link.download = 'ICT_Scout_Jamboree_2025_Photo_Frame.png';
                link.href = finalCanvas.toDataURL('image/png', 1.0);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showMessage('Awesome!', 'Your new photo is ready to share. Click the button to set it as your profile picture!');
            } else {
                showMessage('Oops!', 'Please upload a photo first!');
            }
        });

        function getPointerPos(e) {
            if (e.touches && e.touches.length > 0) {
                return { x: e.touches[0].clientX, y: e.touches[0].clientY };
            }
            return { x: e.clientX, y: e.clientY };
        }
        
        canvas.addEventListener('mousedown', (e) => {
            if (photo) {
                isDragging = true;
                const pos = getPointerPos(e);
                lastPointerX = pos.x;
                lastPointerY = pos.y;
                canvas.classList.add('dragging');
            }
        });
        canvas.addEventListener('touchstart', (e) => {
            if (photo && e.touches.length === 1) {
                isDragging = true;
                const pos = getPointerPos(e);
                lastPointerX = pos.x;
                lastPointerY = pos.y;
                canvas.classList.add('dragging');
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            if (isDragging && photo) {
                const pos = getPointerPos(e);
                const dx = pos.x - lastPointerX;
                const dy = pos.y - lastPointerY;
                photoData.x += dx;
                photoData.y += dy;
                lastPointerX = pos.x;
                lastPointerY = pos.y;
                constrainPhotoPosition();
                draw();
            }
        });
        canvas.addEventListener('touchmove', (e) => {
            if (isDragging && photo && e.touches.length === 1) {
                const pos = getPointerPos(e);
                const dx = pos.x - lastPointerX;
                const dy = pos.y - lastPointerY;
                photoData.x += dx;
                photoData.y += dy;
                lastPointerX = pos.x;
                lastPointerY = pos.y;
                constrainPhotoPosition();
                draw();
            }
        });

        canvas.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.classList.remove('dragging');
        });
        canvas.addEventListener('touchend', () => {
            isDragging = false;
            canvas.classList.remove('dragging');
        });
        canvas.addEventListener('mouseleave', () => {
            isDragging = false;
            canvas.classList.remove('dragging');
        });

        function showMessage(title, text) {
            messageTitle.textContent = title;
            messageText.textContent = text;
            messageBox.classList.remove('hidden');
        }

        closeMessageBtn.addEventListener('click', () => {
            messageBox.classList.add('hidden');
        });
        
        window.addEventListener('resize', fitCanvasToScreen);

        window.onload = function() {
            fitCanvasToScreen();
        };
    });
</script>

</body>
</html>
